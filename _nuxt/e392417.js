(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{293:function(t,e,r){var content=r(311);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(57).default)("5046f186",content,!0,{sourceMap:!1})},310:function(t,e,r){"use strict";r(293)},311:function(t,e,r){var n=r(56)(!1);n.push([t.i,'main[data-v-07a427e8]{margin:1em auto;display:table}main .info[data-v-07a427e8]{display:flex;justify-content:space-between;align-items:center}main .info .progress[data-v-07a427e8]{text-align:right}main .kana[data-v-07a427e8]{font-size:3rem}main .line[data-v-07a427e8]{border-top:1px solid #eee;border-bottom:1px solid #eee;position:relative}main .line[data-v-07a427e8]:after{position:absolute;top:30%;width:100%;left:0;border-top:1px solid hsla(0,0%,78.4%,.5);content:""}main .prompt[data-v-07a427e8]{border-top:1px solid transparent;border-bottom:1px solid transparent}main .display[data-v-07a427e8]{font-size:5rem;padding:2em 0 1em;text-align:center}main .display .typed[data-v-07a427e8]{color:#aaa;padding:0 0 0 1em}main .display .raw_typed[data-v-07a427e8]{color:#aaa}main .display .will_typing[data-v-07a427e8]{padding:0 1em 0 0}main .display .hint[data-v-07a427e8]{font-size:3rem}main .keyboard[data-v-07a427e8]>:nth-child(2){margin-left:2em}main .keyboard[data-v-07a427e8]>:nth-child(3){margin-left:3em}main .keyboard[data-v-07a427e8]>:nth-child(5){margin-left:14em}main .keyboard ul[data-v-07a427e8]{display:flex;padding:0;list-style-type:none;position:relative}main .keyboard ul li[data-v-07a427e8]{border:1px solid #ddd;width:4em;line-height:4em;min-height:4em;text-align:center;margin:.1rem}main .keyboard ul li.pressed[data-v-07a427e8]{background-color:#faa;transform:translateY(.1rem)}main .keyboard ul li.key_Space[data-v-07a427e8]{width:19.8em}main .keyboard ul li.key_ShiftLeft[data-v-07a427e8]{width:5em}main .keyboard ul li.key_ShiftRight[data-v-07a427e8]{width:7.2em}main .keyboard ul li.key_Enter[data-v-07a427e8]{position:absolute;right:0;width:6.2em;height:8.5em;border-left:none;border-bottom:none}main .keyboard ul li.hilight[data-v-07a427e8]{border-color:#ff0}main .histories[data-v-07a427e8]{margin-top:1rem;max-height:30rem;overflow:auto}main .histories>ul[data-v-07a427e8]{display:flex;flex-direction:column-reverse;width:70rem}main .histories .miss_words[data-v-07a427e8]{display:flex;flex-wrap:wrap;list-style-type:none;padding:0}main .histories .miss_word[data-v-07a427e8]{padding:0 1rem;border-radius:.5em;background-color:#faa;color:red;margin:.1rem}main .alert[data-v-07a427e8]{position:fixed;top:0;right:0;bottom:0;left:0;z-index:9999;background-color:rgba(0,0,0,.5);display:flex;justify-content:center;align-items:center}main .alert .popup[data-v-07a427e8]{background-color:#fff;color:#333;border-radius:1em;padding:1em;position:relative;margin-top:-20rem;min-width:30em;min-height:10em;text-align:center}main .alert .popup button[data-v-07a427e8]{position:absolute;top:-2rem;right:-2rem;width:3rem;height:3rem}main .clickable[data-v-07a427e8]{cursor:pointer}main .debug[data-v-07a427e8]{position:fixed;right:0;top:0;background:rgba(0,0,0,.3)}main .debug>dd[data-v-07a427e8]:before{content:"["}main .debug>dd[data-v-07a427e8]:after{content:"]"}main .hidden[data-v-07a427e8]{visibility:hidden}',""]),t.exports=n},325:function(t,e,r){"use strict";r.r(e);r(20),r(26),r(38),r(39);var n=r(87),o=r(23),d=r(5),c=(r(35),r(8),r(14),r(17),r(272),r(43),r(34),r(274),r(276),r(277),r(278),r(279),r(280),r(281),r(282),r(283),r(284),r(285),r(286),r(287),r(288),r(289),r(290),r(291),r(302),r(303),r(37),r(44),r(201),r(127),r(1)),l=r(128),h=r(129),f=function(){function t(e){var r=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new AudioContext;Object(l.a)(this,t),this.url=e,this.context=n;var o=new XMLHttpRequest;o.open("GET",e,!0),o.responseType="arraybuffer",o.onload=Object(d.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.context.decodeAudioData(o.response);case 2:return t.abrupt("return",r.buffer=t.sent);case 3:case"end":return t.stop()}}),t)}))),o.send()}var e;return Object(h.a)(t,[{key:"play",value:(e=Object(d.a)(regeneratorRuntime.mark((function t(){var source;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.buffer){t.next=2;break}return t.abrupt("return");case 2:if("suspended"!=this.context.state){t.next=5;break}return t.next=5,this.context.resume();case 5:(source=this.context.createBufferSource()).buffer=this.buffer,source.connect(this.context.destination),source.start(0);case 9:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})}]),t}(),v=r(292),y=(r(46),r(59),r(199),r(130),r(304),r(36),r(96),r(30),r(202),r(305),r(97),function(){function t(label,code,e){Object(l.a)(this,t),this.label=label,this.code=code,this.clazz=e}return Object(h.a)(t,[{key:"toJSON",value:function(){return{label:this.label,code:this.code,clazz:this.clazz}}}]),t}()),m=function(){function t(){var e=this;Object(l.a)(this,t),this.keymaps=[],this.pressed=[],this.translators=[],this.keydown=function(t){t.preventDefault(),e.pressed.includes(t.keyCode)||e.pressed.push(t.keyCode),e.handler&&e.handler(t.keyCode,t.key)},this.keyup=function(t){t.preventDefault();var r=e.pressed.indexOf(t.keyCode);r>=0&&e.pressed.splice(r,1)}}return Object(h.a)(t,[{key:"attach",value:function(t){t.addEventListener("keydown",this.keydown),t.addEventListener("keyup",this.keyup)}},{key:"detach",value:function(t){t.removeEventListener("keydown",this.keydown),t.removeEventListener("keyup",this.keyup)}},{key:"onpress",set:function(t){this.handler=t}},{key:"is_pressed",value:function(code){return this.pressed.includes(code)}},{key:"is_valid",value:function(code){return null!=this.keymaps.flat().find((function(i){return i.code==code}))}},{key:"load",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.keymaps=t.split(/\r?\n/).map((function(line){return line.split("\t").map((function(t){var e=t.split("|"),r=Object(o.a)(e,3),label=r[0],code=r[1],n=r[2];return new y(label,Number(code),n)}))})),e.length>0&&(this.translators=e.split(/\r?\n/).map((function(line){var t=line.split("\t"),e=Object(v.a)(t);return{to:e[0],froms:e.slice(1)}})))}},{key:"match",value:function(t,input){var e=this,r=function(a,b){var r=e.translators.filter((function(i){return t.startsWith(a(i.to))})),n={from:"",to:""};return r.forEach((function(i){var t=i.froms.filter((function(t){return input.endsWith(b(t))}));if(t.length>0){var e=t.reduce((function(a,b){return a.length>b.length?a:b}));null!=e&&i.to.length>n.to.length&&(n.from=b(e),n.to=a(i.to))}})),n.from.length?n:null};return r((function(i){return"っ"+i}),(function(i){return i.charAt(0)+i}))||r((function(i){return i}),(function(i){return i}))}},{key:"hint",value:function(t){for(var e=this,r=[];t.length>0;)if(/[- ^\\@[;:\],./!"#$%&'()=~|`{+*}<>?_0-9a-zA-Z]/.test(t.charAt(0)))r.push(t.charAt(0)),t=t.substr(1);else{var n=function(a,b){var n=e.translators.filter((function(i){return t.startsWith(a(i.to))})).sort((function(a,b){return b.to.length-a.to.length}))[0];if(null==n)return!1;var o=b(n.froms[0]);return r.push(o),t=t.substr(a(n.to).length),!0};n((function(i){return"っ"+i}),(function(i){return i.charAt(0)+i}))||n((function(i){return i}),(function(i){return i}))}return r.join("")}}]),t}(),_=(r(60),function(){function t(text){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Date,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new Date;Object(l.a)(this,t),this.text=text,this.start=e,this.typed=r,this.raw_typed=n,this.end=o}return Object(h.a)(t,[{key:"duration",get:function(){return this.end.getTime()-this.start.getTime()}},{key:"miss_count",get:function(){return this.typed.length-this.text.length}},{key:"toJSON",value:function(){return{text:this.text,start:this.start,typed:this.typed,raw_typed:this.raw_typed,end:this.end}}}],[{key:"from",value:function(e){return new t(e.text,new Date(e.start),e.typed,e.raw_typed,new Date(e.end))}}]),t}()),w=function(){function t(e,r){Object(l.a)(this,t),this.subject=e,this.records=r,this.miss_words=Object(n.a)(new Set(this.records.filter((function(i){return i.text!=i.typed})).map((function(i){return i.text}))))}return Object(h.a)(t,[{key:"toString",value:function(){var t=this.records.reduce((function(p,t){return p+t.duration}),0),e=Math.floor(t/1e3),r=("000"+t%1e3).slice(-3),n=this.records.reduce((function(p,t){return p+t.typed.length}),0),o=this.records.reduce((function(p,t){return p+t.text.length}),0),d=o/(t/1e3);return"[".concat(this.start.toLocaleString(),"] ").concat(this.subject,"(").concat(this.records.length,") ").concat(e,".").concat(r," 秒 タイプ数 ").concat(n," ミス数 ").concat(n-o," 速度 ").concat(Math.floor(d),".").concat(("00"+Math.floor(100*d)).slice(-2)," 文字/秒")}},{key:"start",get:function(){return this.records[0].start}},{key:"toJSON",value:function(){return{subject:this.subject,records:this.records}}}],[{key:"from",value:function(e){return new t(e.subject,e.records.map(_.from))}}]),t}(),k=(r(203),function(){function t(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r,o=arguments.length>3?arguments[3]:void 0;Object(l.a)(this,t),this.subject=e,this.words=r,this.kanas=n,this.limit_keys=o,console.log(this)}var e;return Object(h.a)(t,[{key:"length",get:function(){return this.words.length}},{key:"toJSON",value:function(){return{subject:this.subject,words:this.words,kanas:this.kanas}}}],[{key:"load",value:(e=Object(d.a)(regeneratorRuntime.mark((function e(r,n,o){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(r.split(/\r?\n/).map(function(){var e=Object(d.a)(regeneratorRuntime.mark((function e(line){var r,d,c,l,h,f,y;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=line.split("\t"),d=Object(v.a)(r),c=d[0],l=d.slice(1),h=l,!c.startsWith("#")){e.next=4;break}return e.abrupt("return");case 4:if(1!=l.length){e.next=10;break}return e.next=7,o(l[0]);case 7:f=e.sent.split(/\r?\n/).filter((function(i){return i.trim().length>0})).map((function(i){return i.split("\t")})),l=f.map((function(i){return i[0]})),h=f.map((function(i){return i[1]||i[0]}));case 10:return y=void 0,c.startsWith("|")&&(y=l.map((function(i){return n.find((function(t){return t.label.toLowerCase()==i}))})).filter((function(i){return null!=i})),c=c.substr(1)),e.abrupt("return",new t(c,l,h,y));case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 2:return e.abrupt("return",e.sent.filter((function(i){return null!=i})));case 3:case"end":return e.stop()}}),e)}))),function(t,r,n){return e.apply(this,arguments)})}]),t}());function x(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"==typeof t)return j(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return j(t,e)}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var i=0,n=function(){};return{s:n,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,d=!0,c=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return d=t.done,t},e:function(t){c=!0,o=t},f:function(){try{d||null==r.return||r.return()}finally{if(c)throw o}}}}function j(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,r=new Array(e);i<e;i++)r[i]=t[i];return r}var O=c.a.extend({data:function(){return{keyboard:new m,typed:"",raw_typed:"",word:"",text:"",hint:"",indexes:[],records:[],doing:!1,histories:[],courses:[],course_index:0,alert:"",se:null,review_course:null}},fetch:function(){var t=this;return Object(d.a)(regeneratorRuntime.mark((function e(){var r,n,d,c,l,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={headers:{Accept:"text/plain"},responseType:"text"},e.next=3,Promise.all([t.$axios.$get("/api/typing/keymaps",r),t.$axios.$get("/api/typing/romaji",r),t.$axios.$get("/api/typing/index",r)]);case 3:return n=e.sent,d=Object(o.a)(n,3),c=d[0],l=d[1],h=d[2],t.keyboard.load(c,l),e.next=11,k.load(h,t.keyboard.keymaps.flat(),(function(e){return t.$axios.$get(e,r)}));case 11:t.courses=e.sent;case 12:case"end":return e.stop()}}),e)})))()},fetchOnServer:!1,created:function(){this.$nuxt.$emit("sidebar_disabled",!0)},mounted:function(){this.se=new f("/type.mp3"),this.histories=localStorage.typing__histories&&JSON.parse(localStorage.typing__histories).map(w.from)||[],this.keyboard.attach(document),this.keyboard.onpress=this.onpress},beforeDestroy:function(){this.keyboard.detach(document)},computed:{will_typing:function(){return this.text.substr(this.typed.length)},record:function(){return this.records[this.records.length-1]},course:function(){return this.review_course?this.review_course:this.courses[this.course_index]}},watch:{histories:function(t){localStorage&&(localStorage.typing__histories=JSON.stringify(t))}},methods:{next:function(){if(this.typed="",this.raw_typed="",this.record&&(this.record.end=new Date),this.indexes.length<=0){if(this.doing=!1,this.histories.push(new w(this.course.subject,this.records)),this.course_index+1<this.courses.length)this.course_index++;else if(this.review_course===this.course){var t=this.histories.slice(-1)[0].miss_words;t.length>0?this.review_course=new k("再復習",t):(this.alert="おめでとうございます！全ステップをクリアしました！",this.review_course=null,this.course_index=0)}else this.review_course=new k("総復習",Object(n.a)(new Set(this.histories.flatMap((function(i){return i.miss_words})))));this.records=[],this.word="",this.text="",this.hint=""}else{var e=this.indexes.shift();this.word=this.course.words[e],this.text=this.course.kanas[e],this.hint=this.keyboard.hint(this.text),this.records.push(new _(this.text))}},setup:function(t){if(this.indexes=Array.from(Array(this.course.length)).map((function(t,i){return i})),t){var e,r=x(this.indexes);try{for(r.s();!(e=r.n()).done;){var i=e.value,n=Math.floor(Math.random()*this.course.length),o=[this.indexes[i],this.indexes[n]];this.indexes[n]=o[0],this.indexes[i]=o[1]}}catch(t){r.e(t)}finally{r.f()}}},onpress:function(code,t){var e;if(this.alert.length>0)this.alert="";else{if(null===(e=this.se)||void 0===e||e.play(),!this.doing&&32==code)return this.setup(!0),this.next(),void(this.doing=!0);if(this.keyboard.is_valid(code)){if(8==code){if(this.typed.length>0){var r=this.typed.slice(-1)[0];this.typed=this.typed.slice(0,-1),this.raw_typed=this.raw_typed.slice(0,-this.keyboard.match(r,this.raw_typed).from.length)}return}if(!this.doing)return;if(this.record.typed+=t,this.record.raw_typed+=t,this.will_typing.charAt(0)==t)this.typed+=t,this.raw_typed+=t;else{var n=this.keyboard.match(this.will_typing,this.record.typed);n&&(this.typed+=n.to,this.record.typed=this.record.typed.slice(0,-n.from.length)+n.to,this.raw_typed+=n.from)}this.typed==this.text&&(this.record.text=this.text,this.next())}}},review:function(t){this.doing?this.alert="終了してからです":this.review_course=new k("".concat(t.start.toLocaleString(),"の復習"),t.miss_words.flatMap((function(i){return[i,i]})))},key_class:function(t){var e={pressed:this.keyboard.is_pressed(t.code)};return t.clazz&&(e["key_"+t.clazz]=!0),this.course.limit_keys&&this.course.limit_keys.find((function(i){return i.code==t.code}))&&(e.hilight=!0),e}}}),C=(r(310),r(45)),component=Object(C.a)(O,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return t.course?r("main",[r("div",{staticClass:"info"},[r("h1",{staticClass:"course"},[t._v("\n      Step "+t._s(t.courses.indexOf(t.course)+1)+" "+t._s(t.course.subject)+"("+t._s(t.course.length)+")\n    ")]),t._v(" "),t.doing?r("div",{staticClass:"progress"},[t._v("あと "+t._s(t.indexes.length+1))]):t._e()]),t._v(" "),t.keyboard.keymaps.length>0?[r("div",{class:{display:!0,doing:t.doing}},[r("div",{class:{kana:!0,hidden:t.word==t.text}},[t.doing?[r("span",{staticClass:"typed"},[t._v(t._s(t.typed))]),r("span",{staticClass:"will_typing"},[t._v(t._s(t.will_typing))])]:t._e(),t._v(" \n      ")],2),t._v(" "),t.doing?[t.word==t.text?r("div",{staticClass:"line"},[r("span",{staticClass:"typed"},[t._v(t._s(t.typed))]),r("span",{staticClass:"will_typing"},[t._v(t._s(t.will_typing))])]):r("div",{staticClass:"line"},[t._v(t._s(t.word))])]:r("div",{staticClass:"prompt"},[t._v("スペースキーで開始します")]),t._v(" "),r("div",{class:{hint:!0,hidden:!t.record||t.hint.startsWith(t.record.raw_typed)}},[r("span",{staticClass:"raw_typed"},[t._v(t._s(t.raw_typed))]),r("span",[t._v(t._s(t.hint.substr(t.raw_typed.length))+" ")])])],2),t._v(" "),r("div",{staticClass:"keyboard"},t._l(t.keyboard.keymaps,(function(e,n){return r("ul",{key:n},t._l(e,(function(e,i){return r("li",{key:i,class:t.key_class(e)},[t._v("\n          "+t._s(e.label)+"\n        ")])})),0)})),0),t._v(" "),r("div",{staticClass:"histories"},[r("h3",[t._v("履歴（クリックすると間違い単語の練習ができます）")]),t._v(" "),r("span",{staticClass:"miss_word"},[t._v("ミスした単語")]),t._v(" "),r("ul",t._l(t.histories,(function(e,i){return r("li",{key:i,class:{clickable:e.miss_words.length>0},on:{click:function(r){e.miss_words.length>0&&t.review(e)}}},[t._v("\n          "+t._s(e)+"\n          "),r("ul",{staticClass:"miss_words"},t._l(e.miss_words,(function(e,n){return r("li",{key:n,staticClass:"miss_word"},[t._v("\n              "+t._s(e)+"\n            ")])})),0)])})),0)])]:t._e(),t._v(" "),t.$is_dev?r("dl",{staticClass:"debug"},[r("dt",[t._v("text")]),t._v(" "),r("dd",[t._v(t._s(t.text))]),t._v(" "),r("dt",[t._v("typed")]),t._v(" "),r("dd",[t._v(t._s(t.typed))]),t._v(" "),r("dt",[t._v("raw_typed")]),t._v(" "),r("dd",[t._v(t._s(t.raw_typed))]),t._v(" "),r("dt",[t._v("record.typed")]),t._v(" "),r("dd",[t._v(t._s(t.record&&t.record.typed))]),t._v(" "),r("dt",[t._v("hint")]),t._v(" "),r("dd",[t._v(t._s(t.hint))]),t._v(" "),r("dt",[t._v("record.raw_typed")]),t._v(" "),r("dd",[t._v(t._s(t.record&&t.record.raw_typed))])]):t._e(),t._v(" "),t.alert.length>0?r("div",{staticClass:"alert"},[r("form",{staticClass:"popup",on:{submit:function(e){e.preventDefault(),t.alert=""}}},[r("p",[t._v(t._s(t.alert))]),t._v(" "),r("button",{attrs:{type:"submit"}},[r("font-awesome-icon",{attrs:{icon:"times"}})],1)])]):t._e()],2):r("main",[t._v("Now Loading...")])}),[],!1,null,"07a427e8",null);e.default=component.exports}}]);